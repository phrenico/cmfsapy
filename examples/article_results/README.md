# Instructions to reproduce the results in "Manifold-adaptive dimension estimation revisited" article

Here I write down the step-by-step instructions to reproduce the results in the aforementioned article.
The instructions assume that you have a proper installation of cmfsapy in your working environment.
Each figure and the table has a script, which generates it.
Some figures have precomputed data, which can be found in a folder or data-generating scripts are available 
in this folder to obtain the required data.

In the followings I write down how to reproduce the results:

## Generate Figure 1
Run the  fig01_FSA_pdfs.py file to generate the first figure about the
empirical and theoretical probability density functions:
```
python fig01_FSA_pdfs.py
```

<embed src="http://phrenico.github.com/cmfsapy/examples/article_results/Figure1.pdf" type="application/pdf">

## Generate Figure 2
Run the fig02medianFSA.py file to generate the second figure:

```
python fig02medianFSA.py
```
The figure contains the sampling distribution of the median for different sample sizes and embedding dimensions.

<embed src="./Figure2.pdf" type="application/pdf">


## Generate Figure 3
Run fig03_dimdep.py to plot the embedding dimension dependence of the medianFSA estimator.
```
python fig03_dimdep.py
```
To speed up the plot-generation process, a supplementary data file: Figure03_data.pkl is available 
with previously measured dimension values.
If you choose to redo the dimension measurements, you can do it by setting the value of gen_and_measure 
boolean parameter to True in the script.

<embed src="./Figure3.pdf" type="application/pdf">

## Generate Figure 4
Run the fig04_convergence.py file to generate Figure 4. 
```
python fig04_convergence.py
```
Data for the plot is stored in the Figure04_data.pkl file.
Fresh data can be generated by setting the gen_and_measure boolean parameter to True,
same as for Fig. 3.

## Generate Figure 5

Run the fig04_convergence.py file to generate Figure 5., which shows the corrigated-mFSA values.
```
python fig05_correction.py
```
Data for the plot is stored in the Figure05_data.pkl file.
Fresh data can be generated by setting the gen_and_measure boolean parameter to True.

## Generate Figure 6
Run the fig06_mpe.py file to generate Figure 6, which shows the comparison of cmFSA and DANCo
on the synthetic benchmark datasets.
```
python fig06_mpe.py
```
The corresponding data files are in the ./benchmark_result folder:
the danco_matlab_benchmark_res.mat matlab file for the results of DANCo
and the cmfsa_benchmark_res.npy npy file for the results of cmFSA.

These data-files can be generated from the scripts in the repository,
for details see the "Generate benchmark data-files and results" section below.

## Generate Figure 7
Run the fig07_epi.py file to generate Figure 7., which shows mean intrinsic dimension values 
at seizures and interictal periods of intracranial EEG recordings.
```
python fig07_epi.py
```
The corresponding data file is Figure07_data.pkl,
this data is a result of elaborate preprocessing pipeline,
therefore it cannot be generated from this repository
(for the details of the analysis see the article).

## Generate Figure S1
Run the figS01_calibration.py file to generate Figure S1, which shows the calibration-procedure
of the cmFSA estimator.
```
python figS01_calibration.py
```
Data is in the ./calibration_result/calibration_data_krange20_n2500_d80.npz file,
which is generated by the gen_calibration_data.py script in the same folder.

The data file contains medianFSA values computed for random d-Dimensional cube datasets
with n=2500 sample size. The simulations were carried out in the 2-80 embedding dimension 
and 1-20 neighborhood range, 100 realizations were generated for each embedding dimension value.

## Generate Figure S2
Run the figS02_epi_embed.py file to generate Figure S2, which shows additional information for the 
time delay embedding of the EEG signals.
```
python figS02_epi_embed.py
```
The data file is at ./epi_embed/embedding_results in numpy binary format
(check the script to see how to load it).

## Generate Table 1
To generate Table 1, run the table.py file.
```
python table.py
```
The corresponding data files are in the ./benchmark_result folder:
- danco_matlab_benchmark_res.mat: matlab file for the results of DANCo matlab implementation
- danco_r_benchmark_res.npy: DANCo R implementation
- ml_benchmark_res.npy: Maximum likelihood estimator (Levina-Bickel) results
- fsa_krange20_benchmark_res.npy: mFSA results
- cmfsa_benchmark_res.npy: npy file for the results of cmFSA.

These data-files can be generated from the scripts in the repository,
for details see the "Generate benchmark data-files and results" section below.

## Generate benchmark data-files and results

### Generate benchmark data
To generate 
